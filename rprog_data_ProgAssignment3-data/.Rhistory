lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue2","gray40"))) # gives the legend lines the correct color and width
)
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads",
legend(2000,9.5, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue2","gray40"))) # gives the legend lines the correct color and width
)
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend(2000,9.5, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue2","gray40"))
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
legend(2000,9.5, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue2","gray40"))
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue2","gray40"))
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue2","gray40")) # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue2","gray40")) # gives the legend lines the correct color and width
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue2","gray40")) # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40")) # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), cex=0.8) # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), cex=0.8, bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
dev.off()
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), cex=0.8, bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
dev.off()
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
dev.off()
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
summary(threePrscRNA)
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,1415448), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="blue2", ylim=c(0,1415448), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", ylim=c(0,1415448), col="gray40", axes=FALSE, xlab="", ylab="")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("blue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,12476418), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
install.package("plotrix")
install.packages("plotrix")
library(plotrix)
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,12476418), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
gap.plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, gap=c(3000000,10000000), gap.axis="y", type="h",
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
col="skyblue2", xlab="Distance to TSS", ylab="Reads", type="h")
gap.plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, gap=c(3000000,10000000), gap.axis="y",
col="skyblue2", xlab="Distance to TSS", ylab="Reads", type="h")
gap.barplot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, gap=c(3000000,10000000), gap.axis="y",
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, gap=c(3000000,10000000), gap.axis="y",
col="skyblue2", xaxlab="Distance to TSS", yaxlab="Reads")
gap.barplot(fivePrscRNA$annotTSS,fivePrscRNA$Position, gap=c(3000000,10000000), gap.axis="y",
col="skyblue2", xaxlab="Distance to TSS", yaxlab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), gap.axis="y",
col="skyblue2", xaxlab="Distance to TSS", yaxlab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), gap.axis="y", xtics=
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000),
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xtics=c(-250:250, 25), xaxlab=c(-250:250, 25)
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xtics=c(-250:250), xaxlab=c(-250:250)
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xtics=c(-250:250), xaxlab=c(-250:250),
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xtics=seq(from=-250, to=250, by 25), xaxlab=seq(from=-250, to=250, by 25),
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xtics=seq(from=-250, to=250, by 25), xaxlab=seq(from=-250, to=250, by 25),
col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xtics=seq(from=-250, to=250, by 25), xaxlab=seq(from=-250, to=250, by 25),col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xtics=seq(from=-250, to=250, by=25), xaxlab=seq(from=-250, to=250, by=25),col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xtics=seq(from=-250, to=250, by=1), xaxlab=seq(from=-250, to=250, by=10),col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(300000,1000000), xtics=seq(from=-250, to=250, by=50), xaxlab=seq(from=-250, to=250, by=50),col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(300000,1000000), xtics=seq(from=-250, to=250, by=1), xaxlab=seq(from=-250, to=250, by=1),col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(300000,1000000), xtics=seq(from=-250, to=250, by=1), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(300000,1000000), xaxlab=seq(from=-250, to=250, by=50), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,12476418), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", axes=FALSE, xlab="", ylab="")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,250000), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,250000), axes=FALSE, xlab="", ylab="")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,300000), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,300000), axes=FALSE, xlab="", ylab="")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,4000000), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,4000000), axes=FALSE, xlab="", ylab="")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,2500000), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,2500000), axes=FALSE, xlab="", ylab="")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1415448), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", ylim=c(0,1415448), col="gray40", axes=FALSE, xlab="", ylab="")
gap.barplot(fivePrscRNA$annotTSS, gap=c(300000,1000000), xaxlab=seq(from=-250, to=250, by=50), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(300000,1000000), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,9000000), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$obsTSS, gap=c(3000000,9000000), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$obsTSS, gap=c(3000000,10000000), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
par(new=TRUE)
gap.barplot(fivePrscRNA$annotTSS, gap=c(3000000,10000000), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$obsTSS, gap=c(3000000,10000000), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
par(new=TRUE)
gap.barplot(fivePrscRNA$annotTSS, xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
gap.barplot(fivePrscRNA$obsTSS, gap=c(3000000,10000000), xaxlab=seq(from=-250, to=250, by=1), col="skyblue2", xlab="Distance to TSS", ylab="Reads")
par(new=TRUE)
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,2500000), bty="n", xlab="Distance to TSS", ylab="Reads")
fivePrDex<-read.table("~/Desktop//5pr_scRNA_dex.txt", sep="\t", header=TRUE)
threePrDex<-read.table("~/Desktop/3pr_scRNA_dex", sep="\t", header=TRUE)
summary(fivePrDex)
summary(fivePrscRNA)
summary(threePrDex)
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,13391133), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrsDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,13391133), axes=FALSE, xlab="", ylab="")
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,13391133), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,13391133), axes=FALSE, xlab="", ylab="")
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,13391133), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,13391133), axes=FALSE, xlab="", ylab="")
plot(threePrDex$annotTSS ~ threePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1199185), xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrDex$obsTSS ~ threePrscRNA$Position, type="h", ylim=c(0,1199185), col="gray40", axes=FALSE, xlab="", ylab="")
summary(fivePrDex)
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1785240), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,1785240), axes=FALSE, xlab="", ylab="")
plot(threePrDex$annotTSS ~ threePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1199185), xlab="Distance to TSS", ylab="Reads", bty="n")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrDex$obsTSS ~ threePrscRNA$Position, type="h", ylim=c(0,1199185), col="gray40", axes=FALSE, xlab="", ylab="", bty="n")
plot(threePrscRNA$annotTSS ~ threePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1415448), xlab="Distance to TSS", ylab="Reads", bty="n")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrscRNA$obsTSS ~ threePrscRNA$Position, type="h", ylim=c(0,1415448), col="gray40", axes=FALSE, xlab="", ylab="", bty="n")
plot(threePrDex$annotTSS ~ threePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1199185), xlab="Distance to TSS", ylab="Reads", bty="n")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(threePrDex$obsTSS ~ threePrscRNA$Position, type="h", ylim=c(0,1199185), col="gray40", axes=FALSE, xlab="", ylab="", bty="n")
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1785240), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,1785240), axes=FALSE, xlab="", ylab="", bty="n")
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,13391133), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,13391133), axes=FALSE, xlab="", ylab="", bty="n")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,2500000), xlim=c(-100,100), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,2500000), xlim=c(-100,100), axes=FALSE, xlab="", ylab="", bty="n")
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1785240), xlim=c(-100,100), bty="n", xlab="Distance to TSS", ylab="Reads")
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,1785240), xlim=c(-100,100), axes=FALSE, xlab="", ylab="", bty="n")
summary(fivePrDex)
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1785240), xlim=c(-100,100), bty="n", xlab="Distance to TSS", ylab="Reads", lwd=1.25)
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,1785240), xlim=c(-100,100), axes=FALSE, xlab="", ylab="", bty="n")
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1785240), xlim=c(-100,100), bty="n", xlab="Distance to TSS", ylab="Reads", lwd=1.75)
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,1785240), xlim=c(-100,100), axes=FALSE, xlab="", ylab="", bty="n")
plot(fivePrDex$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,1785240), xlim=c(-100,100), bty="n", xlab="Distance to TSS", ylab="Reads", lwd=2.25)
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrDex$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,1785240), xlim=c(-100,100), axes=FALSE, xlab="", ylab="", bty="n")
plot(fivePrscRNA$annotTSS ~ fivePrscRNA$Position, type="h", col="skyblue2", ylim=c(0,2500000), xlim=c(-100,100), bty="n", xlab="Distance to TSS", ylab="Reads", lwd=2.25)
legend("topright", inset=.05, # places a legend at the appropriate place
c("annoTSS","obsTSS"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2),col=c("skyblue2","gray40"), bty="n") # gives the legend lines the correct color and width
par(new=TRUE)
plot(fivePrscRNA$obsTSS ~ fivePrscRNA$Position, type="h", col="gray40", ylim=c(0,2500000), xlim=c(-100,100), axes=FALSE, xlab="", ylab="", bty="n")
7.5*15
43/17
28.95/11.05
source('~/Documents/Repos/datasciencecoursera/best.R')
data<-read.csv("outcome-of-care-measures.csv",na.strings="Not Available")
setwd("~/Documents/Repos//datasciencecoursera/rprog_data_ProgAssignment3-data/")
data<-read.csv("outcome-of-care-measures.csv",na.strings="Not Available")
state<-"MI"
outcome<-"heart attack"
outcome<-gsub(" ", ".", outcome)
coln<-colnames(data)
data.s<-data[data$State==state,]
data.s[order(data[,col])]
data.s[order(data[,col]),]
data.s[, order(data[,col])]
data.s[ order(data[col]), ]
search<-paste(c("^Hospital.30.Day.Death..Mortality..Rates.from"),outcome, sep=".")
col<-as.integer(grep(search,colnames(data),ignore.case=TRUE))
col
data.s[ order(data[col]), ]
data.s[ order(data[col]), ][2,1]
data.s[ order(data.s[col]), ]
data.s[ order(data.s[col]), ][2,1]
data.s[ order(data.s[col]), ][1,2]
as.character(data.s[ order(data.s[col]), ][1,2])
num<-1
as.character(data.s[ order(data.s[col]), ][num,2])
data.s<-data[data$State==state && data[,11]!= NA]
as.character(data.s[ order(data.s[col]), ][num,2])
data.s<-data[data$State==state & data[,11]!= NA]
data.s<-data[(data$State==state) & (data[,11]!= NA)]
data.s<-data[(data$State==state) & (data[,col]!= NA)]
data.s<-subset(data, (data$State==state) & (data[,col]!= NA)]
data.s<-subset(data, (data$State==state) & (data[,col]!= NA))
data.s<-subset(data, (data$State==state) & (data[,col]>=0))
summary(data.s)
summary(data.s[,11])
summary(data[data$state=="MI",11])
summary(data[data$State=="MI",11])
num<--1
as.character(data.s[ order(data.s[col]), ][num,2])
as.character(data.s[ order(data.s[col]), ][num:,2])
as.character(data.s[ order(data.s[col]), ][num,2])
as.character(data.s[ order(data.s[col]), ][-2,2])
num<-length(data.s$State)
as.character(data.s[ order(data.s[col]), ][num,2])
rankhospital<-function(state, outcome, num="best"){
## Read outcome data
data<-read.csv("outcome-of-care-measures.csv",na.strings="Not Available")
outcome<-gsub(" ", ".", outcome)
coln<-colnames(data)
##Check that state and outcome are valid
if (!any(data$State == state)){
stop("Invalid State")
}
len<-length(grep(outcome, coln, ignore.case=TRUE))
if ( len == 0){
stop("Invalid outcome")
}
##return hospital name with lowest 30-day death rate in state
if(num=="best"){
num<-1
}
search<-paste(c("^Hospital.30.Day.Death..Mortality..Rates.from"),outcome, sep=".")
col<-as.integer(grep(search,colnames(data),ignore.case=TRUE))
data.s<-subset(data, (data$State==state) & (data[,col]>=0))
if(num=="worst"){
num<-length(data.s$State)
}
as.character(data.s[ order(data.s[col]), ][num,2])
}
rankhospital("TX","heart failure",4)
rankhospital<-function(state, outcome, num="best"){
## Read outcome data
data<-read.csv("outcome-of-care-measures.csv",na.strings="Not Available")
outcome<-gsub(" ", ".", outcome)
coln<-colnames(data)
##Check that state and outcome are valid
if (!any(data$State == state)){
stop("Invalid State")
}
len<-length(grep(outcome, coln, ignore.case=TRUE))
if ( len == 0){
stop("Invalid outcome")
}
##return hospital name with lowest 30-day death rate in state
if(num=="best"){
num<-1
}
search<-paste(c("^Hospital.30.Day.Death..Mortality..Rates.from"),outcome, sep=".")
col<-as.integer(grep(search,colnames(data),ignore.case=TRUE))
data.s<-subset(data, (data$State==state) & (data[,col]>=0))
if(num=="worst"){
num<-length(data.s$State)
}
as.character(data.s[ order(data.s[col]), ][num,2])
}
rankhospital("TX","heart failure",4)
rankhospital("TX","heart failure",1)
data.s<-subset(data, (data$State==state) & (data[,col] != NA))
data<-read.csv("outcome-of-care-measures.csv",na.strings="Not Available")
outcome<-"heart attack"
outcome<-gsub(" ", ".", outcome)
coln<-colnames(data)
search<-paste(c("^Hospital.30.Day.Death..Mortality..Rates.from"),outcome, sep=".")
col<-as.integer(grep(search,colnames(data),ignore.case=TRUE))
as.character(data.s[ order(data.s[col]), ][num,2])
data.s<-subset(data, (data$State==state) & (!is.NA(data[,col])))
state<-"TX"
data.s<-subset(data, (data$State==state) & (!is.NA(data[,col])))
data.s<-subset(data, (data$State==state) & (!is.na(data[,col])))
num<-1
num<-4
as.character(data.s[ order(data.s[col]), ][num,2])
rankhospital<-function(state, outcome, num="best"){
## Read outcome data
data<-read.csv("outcome-of-care-measures.csv",na.strings="Not Available")
outcome<-gsub(" ", ".", outcome)
coln<-colnames(data)
##Check that state and outcome are valid
if (!any(data$State == state)){
stop("Invalid State")
}
len<-length(grep(outcome, coln, ignore.case=TRUE))
if ( len == 0){
stop("Invalid outcome")
}
##return hospital name with lowest 30-day death rate in state
if(num=="best"){
num<-1
}
search<-paste(c("^Hospital.30.Day.Death..Mortality..Rates.from"),outcome, sep=".")
col<-as.integer(grep(search,colnames(data),ignore.case=TRUE))
data.s<-subset(data, (data$State==state) & (!is.na(data[,col])))
if(num=="worst"){
num<-length(data.s$State)
}
as.character(data.s[ order(data.s[col]), ][num,2])
}
rankhospital("TX","heart failure",4)
rankhospital("TX","heart failure",1)
col
col<-as.integer(grep(search,colnames(data),ignore.case=TRUE))
rm(outcome)
rm(col)
rankhospital("TX","heart failure",4)
outcome<-"heart failure"
outcome<-gsub(" ", ".", outcome)
search<-paste(c("^Hospital.30.Day.Death..Mortality..Rates.from"),outcome, sep=".")
col<-as.integer(grep(search,colnames(data),ignore.case=TRUE))
data.s<-subset(data, (data$State==state) & (!is.na(data[,col])))
as.character(data.s[ order(data.s[col]), ][num,2])
rankhospital("MD,"heart attack", "worst"")
rankhospital("MD","heart attack", "worst)
rankhospital("MD","heart attack", "worst")
rankhospital("MD","heart attack", 500000)
source("http://d396qusza40orc.cloudfront.net/rprog%2Fscripts%2Fsubmitscript3.R")
submit
submit()
submit()
submit()
submit()
submit()
submit()
